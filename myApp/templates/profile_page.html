{% extends "layout.html" %}
{% block title %}{{ user.first_name }}'s Profile{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='profile_page.css') }}">
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='profile_page.js') }}"></script>
{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="profile-image">
        <img src="{{ url_for('static', filename=user.image_file) }}" alt="Profile Picture">
    </div>

    <div class="profile-details">
        <p><strong>First Name:</strong> 
            <span id="firstNameText">{{ user.first_name }}</span>
        </p>
        <p><strong>Last Name:</strong> 
            <span id="lastNameText">{{ user.last_name }}</span>
        </p>
        {% if user.phone %}
            <p><strong>Phone Number:</strong> 
                <span id="phoneText">{{ user.phone }}</span>
            </p>
        {% else %}
            <p><strong>Phone Number:</strong> 
                <span id="phoneText">Not provided</span>
            </p>
        {% endif %}
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>Date Joined:</strong> September 1, 2024</p>
    </div>
</div>

<div class="requests-history-container">
    <h3 style="margin-top: 3rem;">Leave History</h3>
    <table class="table table-bordered table-hover">
        <thead class="table-light">
            <tr>
                <th>Leave Type</th>
                <th>From - To</th>
                <th>Pay Requested</th>
                <th>Date Submitted</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for req in all_requests %}
            <tr>
                <td>{{ req.type }}</td>
                <td>{{ req.start_date.strftime('%b %d, %Y') }} - {{ req.end_date.strftime('%b %d, %Y') }}</td>
                <td>{{ 'Yes' if req.is_paid else 'No' }}</td>
                <td>{{ req.start_date.strftime('%b %d, %Y') }}</td>  {# Using start_date as proxy for submission date #}
                <td>
                    {% set status = 'pending' %}  {# Default until you add real status field #}
                    {% if status == 'pending' %}
                        <span class="badge bg-warning text-dark">{{ status }}</span>
                    {% elif status == 'approved' %}
                        <span class="badge bg-success">{{ status }}</span>
                    {% elif status == 'declined' %}
                        <span class="badge bg-danger">{{ status }}</span>
                    {% else %}
                        {{ status }}
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
            {% if not all_requests %}
            <tr>
                <td colspan="5" class="text-center">No leave requests found.</td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}